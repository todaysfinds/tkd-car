{% extends "base.html" %}

{% block page_title %}ë¹ ë¥¸ ì „í™”ë²ˆí˜¸ ê´€ë¦¬{% endblock %}

{% block content %}
<div class="px-4 py-6">
    <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-900 mb-2">ë¹ ë¥¸ ì „í™”ë²ˆí˜¸ ê´€ë¦¬</h1>
        <p class="text-gray-600">ì‹œê°„ëŒ€ë³„ë¡œ í‘œì‹œë˜ëŠ” ë¹ ë¥¸ ì „í™”ë²ˆí˜¸ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    </div>

    <!-- ìƒˆ ë²ˆí˜¸ ì¶”ê°€ -->
    <div class="bg-white rounded-lg shadow-md p-6 mb-6">
        <h2 class="text-lg font-semibold mb-4">ìƒˆ ì „í™”ë²ˆí˜¸ ì¶”ê°€</h2>
        <form id="addNumberForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</label>
                <select name="category" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option value="school">ğŸ« í•™êµ</option>
                    <option value="daycare">ğŸ‘¶ ëŒë´„ì„¼í„°</option>
                    <option value="emergency">ğŸš¨ ì‘ê¸‰ìƒí™©</option>
                    <option value="location">ğŸ“ ì¥ì†Œë³„</option>
                    <option value="custom">âš™ï¸ ê¸°íƒ€</option>
                </select>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ì´ë¦„</label>
                <input type="text" name="name" required placeholder="ì˜ˆ: OOì´ˆë“±í•™êµ êµë¬´ì‹¤" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ì „í™”ë²ˆí˜¸</label>
                <input type="tel" name="phone_number" required placeholder="ì˜ˆ: 02-123-4567" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ì¥ì†Œ (ì„ íƒ)</label>
                <input type="text" name="location" placeholder="ì˜ˆ: í˜„ëŒ€í™ˆíƒ€ìš´ (ì¥ì†Œë³„ ì¹´í…Œê³ ë¦¬ì¸ ê²½ìš°)" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ìš°ì„ ìˆœìœ„</label>
                <input type="number" name="priority" value="5" min="0" max="10" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                <p class="text-xs text-gray-500 mt-1">ìˆ«ìê°€ í´ìˆ˜ë¡ ë¨¼ì € í‘œì‹œë©ë‹ˆë‹¤ (0-10)</p>
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ì„¤ëª… (ì„ íƒ)</label>
                <input type="text" name="description" placeholder="ì˜ˆ: í•™êµ êµë¬´ì‹¤" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="md:col-span-2 lg:col-span-3">
                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors">
                    ì „í™”ë²ˆí˜¸ ì¶”ê°€
                </button>
            </div>
        </form>
    </div>

    <!-- ê¸°ì¡´ ë²ˆí˜¸ ëª©ë¡ -->
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex justify-between items-center mb-4">
            <h2 class="text-lg font-semibold">ë“±ë¡ëœ ì „í™”ë²ˆí˜¸</h2>
            <button onclick="refreshNumbers()" class="text-blue-600 hover:text-blue-800 text-sm">
                ğŸ”„ ìƒˆë¡œê³ ì¹¨
            </button>
        </div>
        
        <!-- ì¹´í…Œê³ ë¦¬ë³„ íƒ­ -->
        <div class="flex space-x-1 mb-4 border-b">
            <button onclick="showCategory('all')" id="tab-all" class="tab-button active px-4 py-2 text-sm font-medium border-b-2 border-blue-500 text-blue-600">
                ì „ì²´
            </button>
            <button onclick="showCategory('school')" id="tab-school" class="tab-button px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                ğŸ« í•™êµ
            </button>
            <button onclick="showCategory('daycare')" id="tab-daycare" class="tab-button px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                ğŸ‘¶ ëŒë´„ì„¼í„°
            </button>
            <button onclick="showCategory('emergency')" id="tab-emergency" class="tab-button px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                ğŸš¨ ì‘ê¸‰ìƒí™©
            </button>
            <button onclick="showCategory('location')" id="tab-location" class="tab-button px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                ğŸ“ ì¥ì†Œë³„
            </button>
            <button onclick="showCategory('custom')" id="tab-custom" class="tab-button px-4 py-2 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700">
                âš™ï¸ ê¸°íƒ€
            </button>
        </div>
        
        <!-- ë²ˆí˜¸ ëª©ë¡ -->
        <div id="numbersList" class="space-y-3">
            <!-- JavaScriptë¡œ ë™ì  ë¡œë“œ -->
        </div>
    </div>

    <!-- ì¹´ì¹´ì˜¤í†¡ ì„¤ì • -->
    <div class="bg-white rounded-lg shadow-md p-6 mt-6">
        <h2 class="text-lg font-semibold mb-4">ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼ ì„¤ì •</h2>
        <div id="kakaoSettings">
            <!-- JavaScriptë¡œ ë™ì  ë¡œë“œ -->
        </div>
    </div>
</div>

<!-- ìˆ˜ì • ëª¨ë‹¬ -->
<div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
    <div class="bg-white rounded-lg p-6 w-full max-w-md mx-4">
        <h3 class="text-lg font-semibold mb-4">ì „í™”ë²ˆí˜¸ ìˆ˜ì •</h3>
        <form id="editForm">
            <input type="hidden" id="editId" name="id">
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</label>
                <select id="editCategory" name="category" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
                    <option value="school">ğŸ« í•™êµ</option>
                    <option value="daycare">ğŸ‘¶ ëŒë´„ì„¼í„°</option>
                    <option value="emergency">ğŸš¨ ì‘ê¸‰ìƒí™©</option>
                    <option value="location">ğŸ“ ì¥ì†Œë³„</option>
                    <option value="custom">âš™ï¸ ê¸°íƒ€</option>
                </select>
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì´ë¦„</label>
                <input type="text" id="editName" name="name" required 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì „í™”ë²ˆí˜¸</label>
                <input type="tel" id="editPhone" name="phone_number" required 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì¥ì†Œ (ì„ íƒ)</label>
                <input type="text" id="editLocation" name="location" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ìš°ì„ ìˆœìœ„</label>
                <input type="number" id="editPriority" name="priority" min="0" max="10" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="mb-4">
                <label class="block text-sm font-medium text-gray-700 mb-2">ì„¤ëª… (ì„ íƒ)</label>
                <input type="text" id="editDescription" name="description" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div class="mb-4">
                <label class="flex items-center">
                    <input type="checkbox" id="editActive" name="is_active" class="mr-2">
                    <span class="text-sm text-gray-700">í™œì„±í™”</span>
                </label>
            </div>
            
            <div class="flex space-x-3">
                <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg transition-colors">
                    ìˆ˜ì •
                </button>
                <button type="button" onclick="closeEditModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 rounded-lg transition-colors">
                    ì·¨ì†Œ
                </button>
            </div>
        </form>
    </div>
</div>

<script>
let currentCategory = 'all';

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', function() {
    loadNumbers();
    loadKakaoSettings();
    
    // ìƒˆ ë²ˆí˜¸ ì¶”ê°€ í¼ ì²˜ë¦¬
    document.getElementById('addNumberForm').addEventListener('submit', function(e) {
        e.preventDefault();
        addNumber();
    });
    
    // ìˆ˜ì • í¼ ì²˜ë¦¬
    document.getElementById('editForm').addEventListener('submit', function(e) {
        e.preventDefault();
        updateNumber();
    });
});

// ë²ˆí˜¸ ëª©ë¡ ë¡œë“œ
function loadNumbers() {
    fetch('/api/quick_call_numbers')
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            displayNumbers(data.numbers);
        } else {
            alert('ë²ˆí˜¸ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('ë²ˆí˜¸ ëª©ë¡ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
}

// ë²ˆí˜¸ ëª©ë¡ í‘œì‹œ
function displayNumbers(numbers) {
    const container = document.getElementById('numbersList');
    container.innerHTML = '';
    
    const categories = ['school', 'daycare', 'emergency', 'location', 'custom'];
    const categoryNames = {
        'school': 'ğŸ« í•™êµ',
        'daycare': 'ğŸ‘¶ ëŒë´„ì„¼í„°', 
        'emergency': 'ğŸš¨ ì‘ê¸‰ìƒí™©',
        'location': 'ğŸ“ ì¥ì†Œë³„',
        'custom': 'âš™ï¸ ê¸°íƒ€'
    };
    
    categories.forEach(category => {
        if (!numbers[category] || numbers[category].length === 0) return;
        
        const categoryDiv = document.createElement('div');
        categoryDiv.className = `category-section ${currentCategory !== 'all' && currentCategory !== category ? 'hidden' : ''}`;
        categoryDiv.setAttribute('data-category', category);
        
        if (currentCategory === 'all') {
            const categoryHeader = document.createElement('h3');
            categoryHeader.className = 'text-md font-medium text-gray-800 mb-2 mt-4 first:mt-0';
            categoryHeader.textContent = categoryNames[category];
            categoryDiv.appendChild(categoryHeader);
        }
        
        numbers[category].forEach(number => {
            const numberDiv = document.createElement('div');
            numberDiv.className = 'flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50';
            
            numberDiv.innerHTML = `
                <div class="flex-1">
                    <div class="flex items-center space-x-3">
                        <span class="font-medium text-gray-900">${number.name}</span>
                        <span class="text-sm text-blue-600">${number.phone_number}</span>
                        ${number.location ? `<span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">${number.location}</span>` : ''}
                        <span class="text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded">ìš°ì„ ìˆœìœ„: ${number.priority || 0}</span>
                    </div>
                    ${number.description ? `<p class="text-sm text-gray-600 mt-1">${number.description}</p>` : ''}
                </div>
                <div class="flex space-x-2">
                    <button onclick="editNumber(${number.id})" class="text-blue-600 hover:text-blue-800 text-sm px-2 py-1 rounded hover:bg-blue-50">
                        ìˆ˜ì •
                    </button>
                    <button onclick="deleteNumber(${number.id})" class="text-red-600 hover:text-red-800 text-sm px-2 py-1 rounded hover:bg-red-50">
                        ì‚­ì œ
                    </button>
                    <button onclick="testCall('${number.phone_number}', '${number.name}')" class="text-green-600 hover:text-green-800 text-sm px-2 py-1 rounded hover:bg-green-50">
                        ğŸ“ í…ŒìŠ¤íŠ¸
                    </button>
                </div>
            `;
            
            categoryDiv.appendChild(numberDiv);
        });
        
        container.appendChild(categoryDiv);
    });
    
    if (container.innerHTML === '') {
        container.innerHTML = '<p class="text-gray-500 text-center py-8">ë“±ë¡ëœ ì „í™”ë²ˆí˜¸ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
    }
}

// ì¹´í…Œê³ ë¦¬ í‘œì‹œ
function showCategory(category) {
    currentCategory = category;
    
    // íƒ­ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ë³€ê²½
    document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active', 'border-blue-500', 'text-blue-600');
        btn.classList.add('border-transparent', 'text-gray-500');
    });
    
    const activeTab = document.getElementById(`tab-${category}`);
    activeTab.classList.add('active', 'border-blue-500', 'text-blue-600');
    activeTab.classList.remove('border-transparent', 'text-gray-500');
    
    // ì¹´í…Œê³ ë¦¬ë³„ ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€
    document.querySelectorAll('.category-section').forEach(section => {
        if (category === 'all') {
            section.classList.remove('hidden');
        } else {
            if (section.getAttribute('data-category') === category) {
                section.classList.remove('hidden');
            } else {
                section.classList.add('hidden');
            }
        }
    });
}

// ìƒˆ ë²ˆí˜¸ ì¶”ê°€
function addNumber() {
    const formData = new FormData(document.getElementById('addNumberForm'));
    const data = Object.fromEntries(formData.entries());
    
    fetch('/api/quick_call_numbers', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('ì „í™”ë²ˆí˜¸ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
            document.getElementById('addNumberForm').reset();
            loadNumbers();
        } else {
            alert('ì¶”ê°€ ì‹¤íŒ¨: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
}

// ë²ˆí˜¸ ìˆ˜ì •
function editNumber(id) {
    // í˜„ì¬ ë°ì´í„° ê°€ì ¸ì™€ì„œ í¼ì— ì±„ìš°ê¸°
    fetch(`/api/quick_call_numbers`)
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // ëª¨ë“  ë²ˆí˜¸ì—ì„œ í•´ë‹¹ ID ì°¾ê¸°
            let targetNumber = null;
            Object.values(data.numbers).forEach(categoryNumbers => {
                const found = categoryNumbers.find(num => num.id === id);
                if (found) targetNumber = found;
            });
            
            if (targetNumber) {
                document.getElementById('editId').value = targetNumber.id;
                document.getElementById('editCategory').value = targetNumber.category || '';
                document.getElementById('editName').value = targetNumber.name || '';
                document.getElementById('editPhone').value = targetNumber.phone_number || '';
                document.getElementById('editLocation').value = targetNumber.location || '';
                document.getElementById('editPriority').value = targetNumber.priority || 0;
                document.getElementById('editDescription').value = targetNumber.description || '';
                document.getElementById('editActive').checked = targetNumber.is_active !== false;
                
                document.getElementById('editModal').classList.remove('hidden');
            }
        }
    });
}

// ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸°
function closeEditModal() {
    document.getElementById('editModal').classList.add('hidden');
}

// ë²ˆí˜¸ ì—…ë°ì´íŠ¸
function updateNumber() {
    const formData = new FormData(document.getElementById('editForm'));
    const data = Object.fromEntries(formData.entries());
    data.is_active = document.getElementById('editActive').checked;
    
    const id = document.getElementById('editId').value;
    
    fetch(`/api/quick_call_numbers/${id}`, {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('ì „í™”ë²ˆí˜¸ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
            closeEditModal();
            loadNumbers();
        } else {
            alert('ìˆ˜ì • ì‹¤íŒ¨: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
}

// ë²ˆí˜¸ ì‚­ì œ
function deleteNumber(id) {
    if (!confirm('ì´ ì „í™”ë²ˆí˜¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
    
    fetch(`/api/quick_call_numbers/${id}`, {
        method: 'DELETE'
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('ì „í™”ë²ˆí˜¸ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            loadNumbers();
        } else {
            alert('ì‚­ì œ ì‹¤íŒ¨: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
}

// ì „í™” í…ŒìŠ¤íŠ¸
function testCall(phoneNumber, name) {
    if (confirm(`${name} (${phoneNumber})ë¡œ ì „í™”ë¥¼ ê±¸ê¹Œìš”?`)) {
        window.location.href = `tel:${phoneNumber}`;
    }
}

// ëª©ë¡ ìƒˆë¡œê³ ì¹¨
function refreshNumbers() {
    loadNumbers();
}

// ì¹´ì¹´ì˜¤í†¡ ì„¤ì • ë¡œë“œ
function loadKakaoSettings() {
    fetch('/api/kakao_settings')
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            displayKakaoSettings(data.settings);
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
}

// ì¹´ì¹´ì˜¤í†¡ ì„¤ì • í‘œì‹œ
function displayKakaoSettings(settings) {
    const container = document.getElementById('kakaoSettings');
    container.innerHTML = `
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì • ID</label>
                <input type="text" id="businessId" value="${settings.business_id || ''}" placeholder="ì¹´ì¹´ì˜¤ ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì • ID" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">í…œí”Œë¦¿ ID</label>
                <input type="text" id="templateId" value="${settings.template_id || ''}" placeholder="ë©”ì‹œì§€ í…œí”Œë¦¿ ID" 
                       class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            
            <div>
                <label class="flex items-center">
                    <input type="checkbox" id="isActive" ${settings.is_active ? 'checked' : ''} class="mr-2">
                    <span class="text-sm text-gray-700">ì¹´ì¹´ì˜¤í†¡ ì•Œë¦¼ í™œì„±í™”</span>
                </label>
            </div>
            
            <div>
                <label class="flex items-center">
                    <input type="checkbox" id="testMode" ${settings.test_mode ? 'checked' : ''} class="mr-2">
                    <span class="text-sm text-gray-700">í…ŒìŠ¤íŠ¸ ëª¨ë“œ (ì‹¤ì œ ë°œì†¡ ì•ˆí•¨)</span>
                </label>
            </div>
        </div>
        
        <div class="mt-4">
            <button onclick="saveKakaoSettings()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                ì¹´ì¹´ì˜¤í†¡ ì„¤ì • ì €ì¥
            </button>
            <p class="text-sm text-gray-600 mt-2">
                ğŸ’¡ ì‹¤ì œ ì¹´ì¹´ì˜¤í†¡ ë°œì†¡ì„ ìœ„í•´ì„œëŠ” ì¹´ì¹´ì˜¤ ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì •ê³¼ API ì—°ë™ì´ í•„ìš”í•©ë‹ˆë‹¤.
            </p>
        </div>
    `;
}

// ì¹´ì¹´ì˜¤í†¡ ì„¤ì • ì €ì¥
function saveKakaoSettings() {
    const data = {
        business_id: document.getElementById('businessId').value,
        template_id: document.getElementById('templateId').value,
        is_active: document.getElementById('isActive').checked,
        test_mode: document.getElementById('testMode').checked
    };
    
    fetch('/api/kakao_settings', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('ì¹´ì¹´ì˜¤í†¡ ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
        } else {
            alert('ì €ì¥ ì‹¤íŒ¨: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    });
}
</script>

<style>
.tab-button.active {
    border-bottom-color: #3b82f6 !important;
    color: #3b82f6 !important;
}
</style>
{% endblock %} 